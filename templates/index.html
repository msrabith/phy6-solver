<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Physics Solver</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&family=JetBrains+Mono&family=STIX+Two+Text&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Exo+2&display=swap" rel="stylesheet">

    <!-- Custom Dark Theme -->
        <style>
            body {
                background-color: #0d1117;
                color: #e6edf3;
                font-family: 'STIX Two Text', serif;
            }

            .glass-card {
                background: rgba(255, 255, 255, 0.05);
                backdrop-filter: blur(10px);
                border: 1px solid rgba(255, 255, 255, 0.1);
                border-radius: 12px;
                padding: 30px;
                box-shadow: 0 0 25px rgba(0,0,0,0.4);
            }

            textarea {
                font-family: 'JetBrains Mono', monospace;
                background-color: #161b22;
                color: #e6edf3;
                border: 1px solid #30363d;
            }

            textarea:focus {
                font-family: 'JetBrains Mono', monospace;
                background-color: #161b22;
                color: #fff;
                border-color: #58a6ff;
                box-shadow: 0 0 0 0.2rem rgba(88,166,255,0.25);
            }

            .btn-primary {
                background-color: #238636;
                border-color: #238636;
            }

            .btn-primary:hover {
                background-color: #2ea043;
                border-color: #2ea043;
            }

            .solution {
                background-color: #161b22;
                border: 1px solid #30363d;
                color: #e6edf3;
                border-radius: 10px;
            }

            .solution pre{
                font-size: 20px;
                white-space: pre-wrap;
                word-wrap: break-word;
            }

            #loading {
            background: rgba(0, 0, 0, 0.4);
            padding: 20px;
            border-radius: 12px;
            backdrop-filter: blur(8px);
            }


            h1, h3 {
                font-family: 'Exo 2', sans-serif;
                color: #FFE3BD;
            }

            p{
                color: #EDDEFA;
            }

            .btn-glass-blue {
                background: rgba(88, 166, 255, 0.15); /* transparent blue */
                border: 1px solid rgba(88, 166, 255, 0.4);
                color: #58a6ff;
                backdrop-filter: blur(8px);
                padding: 10px 20px;
                border-radius: 10px;
                transition: 0.25s ease;
                font-weight: 500;
            }

            .btn-glass-blue:hover {
                background: rgba(88, 166, 255, 0.25);
                border-color: rgba(88, 166, 255, 0.8);
                box-shadow: 0 0 15px rgba(88, 166, 255, 0.6);
                color: #ffffff;
            }

        </style>

    <!-- MathJax -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
</head>

<body>
    <div class="container mt-5">
        <div class="glass-card">

            <h1 class="text-center mb-4">PHY6 Solver</h1>
            <p class="mb-3">TYPE A PHYSICS PROBLEM BELOW :</p>

            <form method="post" enctype="multipart/form-data" onsubmit="showLoading()">
                <textarea rows="6" name="problem" class="form-control mb-3"
                placeholder="Type your physics problem here...">{{problem}}</textarea>

                <p class="mt-3">OR UPLOAD A PHOTO OF THE PROBLEM :<br>You can also paste an image here (Ctrl + V)</p>


                <input type="file"
                       name="problem_image"
                       accept="image/*"
                       class="form-control mb-3"
                       >

                <input type="file"
                       id="hiddenImageInput"
                       name="problem_image"
                       hidden>

                <button type="submit" class="btn btn-glass-blue w-100">Solve</button>
            </form>

            <div id="loading" class="text-center mt-4" style="display:none;">
                <div class="spinner-border text-info" role="status"></div>
                <p class="mt-2">Processingâ€¦ Please wait</p>
            </div>

            {% if solution %}
                <h3 class="mt-4">Solution:</h3>
                <div class="solution p-3 mt-2">
                    <pre>{{ solution | safe }}</pre>
                </div>
            {% endif %}

        </div>

    </div>

    <script>
    document.addEventListener("paste", function (event) {
        const items = event.clipboardData.items;

        for (let i = 0; i < items.length; i++) {
            if (items[i].type.indexOf("image") !== -1) {

                // Show loading indicator
                document.getElementById("loading").style.display = "block";

                const blob = items[i].getAsFile();
                const formData = new FormData();
                formData.append("problem_image", blob);

                fetch("/", {
                    method: "POST",
                    body: formData
                })
                .then(response => response.text())
                .then(html => {
                    document.open();
                    document.write(html);
                    document.close();
                });

                break;
            }
        }
    });
    </script>

    <script>
        function showLoading(){
            document.getElementById("loading").style.display = "block";
        }
    </script>
</body>
</html>
